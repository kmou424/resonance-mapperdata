# 雷索纳斯 跑商数据 API接口

本项目是一个因为一些原因闭源但公开使用的雷索纳斯跑商数据 API，旨在为各位列车长共享实时跑商数据，协助攻略开发。通过本文档，你将了解到如何使用此 API，并知晓如何参与贡献本项目。

## 接口地址

API 接口地址：[https://reso-data.kmou424.moe/](https://reso-data.kmou424.moe/)

## API 文档

### 授权

为了方便目前阶段的数据维护，暂时不上线鉴权，也就是说 API 将会完全公开，禁止大流量高并发恶意请求，否则会封禁IP。

### API 文档

#### GET /api/fetch/goods_info

此接口为通用数据获取接口。

##### 请求参数

| 参数名  | 类型   | 位置  | 描述                          | 是否必需        |
| ------- | ------ | ----- | ----------------------------- | --------------- |
| station | string | query | 站点名（中文，如“7号自由港”） | -               |
| good    | string | query | 商品名（中文，如“发动机”）    | -               |
|         |        |       |                               | 至少传入1个参数 |

##### 返回参数

| 参数名             | 类型   | 描述                                       |
| ------------------ | ------ | ------------------------------------------ |
| [object]           | array  | 商品信息数组                               |
| > name             | string | 商品名（中文，如“发动机”）                 |
| > station          | string | 站点名（中文，如“7号自由港”）              |
| > price            | number | 当前价格                                   |
| > next_trend       | number | 下次价格变化趋势（> 0 则上涨，< 0 则下降） |
| > update_time      | string | 更新时间（UTC +0; yyyy-MM-dd HH:mm:ss）    |
| > update_timestamp | number | 更新时间（UTC +0; Unix时间戳）             |

#### GET /api/fetch/full_goods_info

此接口仅供比对数据为本项目做贡献使用。

##### 请求参数

| 参数名  | 类型   | 位置  | 描述                                                         | 是否必需 |
| ------- | ------ | ----- | ------------------------------------------------------------ | -------- |
| station | string | query | 站点名（中文，如“7号自由港”）                                | 是       |
| show    | string | query | 筛选（不指定则默认full，显示所有数据；可选unknown，仅显示未记录在映射表里的数据） | 否       |

##### 返回参数

| 参数名             | 类型   | 描述                                                    |
| ------------------ | ------ | ------------------------------------------------------- |
| [object]           | array  | 商品信息数组                                            |
| > id               | string | 商品编号，仅作数据维护使用                              |
| > name             | string | 商品名（中文，如“发动机”，未记录数据则显示为“Unknown”） |
| > station          | string | 站点名（中文，与传入station保持一致）                   |
| > price            | number | 当前价格                                                |
| > next_trend       | number | 下次价格变化趋势（> 0 则上涨，< 0 则下降）              |
| > update_time      | string | 更新时间（UTC +0; yyyy-MM-dd HH:mm:ss）                 |
| > update_timestamp | number | 更新时间（UTC +0; Unix时间戳）                          |

### 更多

API 的数据更新频率为 5 分钟一次。

由于技术原因，每个站点都需要一个账号来获取商品信息，以下是目前已支持的站点列表：

- [x] 修格里城
- [x] 铁盟哨站
- [x] 7号自由港
- [x] 澄明数据中心
- [ ] 阿妮塔战备工厂（需要lv.40账号）
- [x] 阿妮塔能源研究所
- [ ] 荒原站
- [ ] 曼德矿场
- [ ] 淘金乐园

## 参与贡献

基于游戏跑商机制，同一个商品在不同的城市是不同的价格，所以我使用了一种`ID -->(映射)--> 站点&商品`的映射表设计，来进行后端的数据处理。目前有很多只知道ID与价格的商品并没有完成一一对应。并且 API 接口能提供的数据也可以进一步完善。所以对于如何到参与项目的贡献中来，你有许多选择：

1. 完善映射表：调用接口`/api/fetch/full_goods_info`来获取你当前游戏账号所在站点的未完善商品数据，然后把数据和游戏界面中显示的价格进行一一对比，如果相同则代表该数据中的ID对应此站点中的此商品，你获取到了一组正确的映射数据。以本仓库目录下`goods_cities_mapper.example.json`中的示例格式，将你获取到的映射数据以**示例格式**和**正确**的`json`语法填写进`goods_cities_mapper.json`中，并向项目提交Pull Request。

   推荐额外步骤：使用仓库目录下的`sorter.py`，执行`python sorter.py -f goods_cities_mapper.json -s name -g station -o goods_cities_mapper.json`。映射表文件将会自动排序，使文件可读性增强。

   Tips：获取到的商品数据中，如果是本地商品，则是在当前站点的**买入价**；如果是外地商品，则是在当前站点的**卖出价**。

2. 提出改进建议/功能请求：在项目的 issues 页面中发起一个 issue，标题按照`[类型] 标题`的格式来编写，类型包含：建议、功能请求、BUG。 

3. 如果你不会以上复杂的操作，但也想要帮助项目发展，请转到页面的最下方加入 QQ 群或是直接转到 [腾讯文档-商品-站点-ID映射表](https://docs.qq.com/sheet/DSnJpUE5MQUxVZWFD?tab=jyci4r) 并阅读其中的教程后参与完善工作。

在提交 Pull Request 和 Issue 前，请确保遵守上文中的规范。

## 联系我

- QQ群：493153096

